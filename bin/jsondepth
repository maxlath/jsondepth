#!/usr/bin/env node
const { file, showHelp } = require('../lib/parse_arguments')
const { append, log } = require('../lib/aggregator')

if (showHelp) {
  require('../lib/show_help')()
} else if (file) {
  log(file)
} else {
  process.stdin
  .on('data', append)
  .on('end', log)
}

// Prevent logging an EPIPE error when piping the output
// cf https://github.com/maxlath/wikidata-cli/issues/7
process.stdout.on('error', function (err) {
  if (err.code !== 'EPIPE') throw err
})
